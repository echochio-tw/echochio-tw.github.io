I"¸"<p>Mojoliciouså®‰è£…ï¼š</p>

<p>åœ¨ windows å®‰è£æ¸¬è©¦æ©Ÿ â€¦ç”¨ vagrant</p>

<p>é™„ä¸Š vagrantfile</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- mode: ruby -*-</span>
<span class="c1"># vi: set ft=ruby :</span>

<span class="no">VAGRANTFILE_API_VERSION</span> <span class="o">=</span> <span class="s2">"2"</span>

<span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="no">VAGRANTFILE_API_VERSION</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">box</span> <span class="o">=</span> <span class="s2">"bento/centos-7.5"</span>
  <span class="c1"># If you run into issues with Ansible complaining about executable permissions,</span>
  <span class="c1"># comment the following statement and uncomment the next one.</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"."</span><span class="p">,</span> <span class="s2">"/vagrant"</span>
  <span class="c1"># config.vm.synced_folder ".", "/vagrant", mount_options: ["dmode=700,fmode=600"]</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provider</span> <span class="s2">"virtualbox"</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span>
    <span class="n">v</span><span class="p">.</span><span class="nf">memory</span> <span class="o">=</span> <span class="mi">1024</span>
  <span class="k">end</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">primary: </span><span class="kp">true</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span>
    <span class="n">user</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="ss">:forwarded_port</span><span class="p">,</span> <span class="ss">host: </span><span class="mi">8080</span><span class="p">,</span> <span class="ss">guest: </span><span class="mi">8080</span>
	<span class="n">user</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="ss">:forwarded_port</span><span class="p">,</span> <span class="ss">host: </span><span class="mi">3000</span><span class="p">,</span> <span class="ss">guest: </span><span class="mi">3000</span>
    <span class="c1">#user.vm.network :forwarded_port, host: 5000, guest: 5000</span>
    <span class="c1">#user.vm.network :forwarded_port, host: 9999, guest: 9999</span>
    <span class="n">user</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="ss">:forwarded_port</span><span class="p">,</span> <span class="ss">host: </span><span class="mi">2201</span><span class="p">,</span> <span class="ss">guest: </span><span class="mi">22</span><span class="p">,</span> <span class="ss">id: </span><span class="s2">"ssh"</span><span class="p">,</span> <span class="ss">auto_correct: </span><span class="kp">true</span>
    <span class="n">user</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.50.91"</span>
    <span class="c1"># added dynamic swap file management to prevent "Free Swap Space: 0 B" warning in Jenkins</span>
    <span class="c1">#user.vm.provision "shell", path: "bootstrap.sh"</span>
    <span class="c1">#user.vm.provision :shell, inline: 'ansible-playbook /vagrant/ansible/user.yml -c local -v'</span>
    <span class="c1">#user.vm.hostname = "cd"</span>
  <span class="k">end</span>
  <span class="k">if</span> <span class="no">Vagrant</span><span class="p">.</span><span class="nf">has_plugin?</span><span class="p">(</span><span class="s2">"vagrant-cachier"</span><span class="p">)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">cache</span><span class="p">.</span><span class="nf">scope</span> <span class="o">=</span> <span class="ss">:box</span>
  <span class="k">end</span>
<span class="c1"># if Vagrant.has_plugin?("vagrant-proxyconf")</span>
<span class="c1">#   config.proxy.http     = "http://proxy.company.com:8080/"</span>
<span class="c1">#   config.proxy.https    = "http://proxy.company.com:8080/"</span>
<span class="c1">#   config.proxy.no_proxy = "localhost,127.0.0.1"</span>
<span class="c1"># end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>è£Centos â€¦åŠæ›´æ–°é‚„æœ‰ update ,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install -y epel-release
yum update
yum groupinstall -y "Development Tools"
</code></pre></div></div>

<p>ä¸çŸ¥ç‚ºä½• OS å…§çš„ perl è£ Mojolicious æ€ªæ€ªçš„ â€¦. å¥½å§ â€¦è‡ªå·±ä¾†è£ perl</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://www.cpan.org/src/5.0/perl-5.28.0.tar.gz
tar zxvf perl-5.28.0.tar.gz
cd perl-5.28.0
./Configure -des -Dprefix=/usr
make ; make install
</code></pre></div></div>

<p>çœ‹ perl</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># perl -v

This is perl 5, version 28, subversion 0 (v5.28.0) built for x86_64-linux

Copyright 1987-2018, Larry Wall

Perl may be copied only under the terms of either the Artistic License or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using "man perl" or "perldoc perl".  If you have access to the
Internet, point your browser at http://www.perl.org/, the Perl Home Page.

</code></pre></div></div>

<p>ç”¨ CPAN ä¾†è£ â€¦.å•¥ â€¦ä¸çŸ¥ CAPN é‚£ä¸è¦ç© perl äº† â€¦.XD</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -MCPAN -e shell
install Mojolicious
</code></pre></div></div>

<p>å¯«å€‹  helloword</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/perl</span>
<span class="k">use</span> <span class="nn">Mojolicious::</span><span class="nv">Lite</span><span class="p">;</span>

<span class="nv">get</span> <span class="p">'</span><span class="s1">/:foo</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="k">sub </span><span class="p">{</span>
  <span class="k">my</span> <span class="nv">$c</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
  <span class="k">my</span> <span class="nv">$foo</span>  <span class="o">=</span> <span class="nv">$c</span><span class="o">-&gt;</span><span class="nv">param</span><span class="p">('</span><span class="s1">foo</span><span class="p">');</span>
  <span class="nv">$c</span><span class="o">-&gt;</span><span class="nv">render</span><span class="p">(</span><span class="nv">text</span> <span class="o">=&gt;</span> <span class="p">"</span><span class="s2">Hello from </span><span class="si">$foo</span><span class="s2">.</span><span class="p">");</span>
<span class="p">};</span>

<span class="nv">app</span><span class="o">-&gt;</span><span class="nv">start</span><span class="p">;</span>
</code></pre></div></div>

<p>å°±åŸ·è¡Œçœ‹çœ‹ â€¦..</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chmod +x hello.pl
#  ./hello.pl  daemon -m production -l http://*:8080
[Sat Nov  3 03:17:41 2018] [info] Listening at "http://*:8080"
Server available at http://127.0.0.1:8080
</code></pre></div></div>

<p>åˆ°æœ¬æ©Ÿç«¯ â€¦.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># curl http://127.0.0.1:8080/aaaa
Hello from aaaa
#
</code></pre></div></div>

<p>ç•¶ç„¶ä½ ä¸æƒ³æ”¾å‰ç«¯ â€¦ é‚£ç”¨ nginx ç•¶ proxy â€¦</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>upstream myapp {
  server 127.0.0.1:3000;
}
server {
  listen 8080;
  server_name localhost;
  location / {
    proxy_pass http://myapp;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }
}
</code></pre></div></div>
:ET