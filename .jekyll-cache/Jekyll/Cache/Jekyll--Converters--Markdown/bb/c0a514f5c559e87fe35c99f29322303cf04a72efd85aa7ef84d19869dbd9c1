I"7<p>有時會忘記紀錄一下 (裡面跑 python , shell ,perl …. 都可)</p>

<p>作法是寫個 C 然後 suid 到 root , 用這 C 編譯好的去執行 ….</p>

<p>當然要 suid –&gt; 4755</p>

<p>C 的程式如下</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
int main(int argc, char* argv[])
{
setuid(0);
char str[200];
strcpy (str,"python /var/www/html/58yumi/58yumi_set_new.py ");
strcat (str,argv[1]);
strcat (str," ");
strcat (str,argv[2]);
system(str);
return 0;
}
</code></pre></div></div>

<p>編譯然後 , suid –&gt;  chmod 4755</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc /var/www/html/58yumi/58yumi_set_new.c -o /var/www/html/58yumi/58yumi_set_new
chmod 4755 /var/www/html/58yumi/58yumi_set_new
</code></pre></div></div>

<p>就網頁呼叫 這個 C … 例如 php :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s2">"/var/www/html/58yumi/58yumi_set_new xxxx 1234"</span><span class="p">)</span> <span class="p">;</span>
</code></pre></div></div>
:ET