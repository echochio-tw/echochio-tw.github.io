I"š<p>é¦–å…ˆè¦å°‡ bot çš„ Privacy mode æ”¹ç‚º disable é€™æ¨£ chat group çš„ bot å°±æœƒæ”¶åˆ°æ‰€æœ‰è¨Šæ¯ â€¦</p>

<p>æ‰€ä»¥é€™å€‹ Privacy mode æ”¹ç‚º disable çš„ bot ä¸èƒ½ç”¨åœ¨å¤šç¾¤çµ„å…§, åªèƒ½ç”¨æ–¼å–®ä¸€ chat group</p>

<p>ä¸ç„¶æœƒæ”¶åˆ°ä¸€å¤§å †è¨Šæ¯æŠŠ webhoos ææ›äº†</p>

<p>é€²å» BotFather è¨­å®š Privacy mode</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/mybots -&gt; select bot -&gt; Bot Settings -&gt; Privacy mode -&gt; disabled (defult Enable)
</code></pre></div></div>

<p>é€™é‚Šç”¨ ubuntu +  ngrok</p>

<p>äº‹å¯¦æˆ‘ç”¨ win10çš„ WSL è«‹åƒè€ƒ https://www.echochio.nctu.me/2019/05/win10-WSL-ubuntu/</p>

<p>ngrok å®‰è£ æ¸…åƒè€ƒå®˜ç¶²</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://dashboard.ngrok.com/get-started
</code></pre></div></div>

<p>æˆ‘å¯«çš„ python åŸ·è¡Œ â€¦.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
</span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">telegram</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">telegram.ext</span> <span class="kn">import</span> <span class="n">Dispatcher</span><span class="p">,</span> <span class="n">MessageHandler</span><span class="p">,</span> <span class="n">Filters</span>

<span class="n">bot</span> <span class="o">=</span> <span class="n">telegram</span><span class="o">.</span><span class="n">Bot</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s">"917681111:AAFpNGEoiebe1yXbkHDVbaauKAjzDSJLjs"</span><span class="p">)</span>
<span class="n">chat_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">341335110</span>

<span class="k">def</span> <span class="nf">telegram_send</span><span class="p">(</span><span class="n">bot_message</span><span class="p">):</span>
    <span class="n">bot_token</span> <span class="o">=</span> <span class="s">"917681111:AAFpNGEoiebe1yXbkHDVbaauKAjzDSJLjs"</span>
    <span class="n">send_text</span> <span class="o">=</span> <span class="s">'https://api.telegram.org/bot'</span> <span class="o">+</span> <span class="n">bot_token</span> <span class="o">+</span> <span class="s">'/sendMessage?chat_id='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chat_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">'&amp;parse_mode=Markdown&amp;text='</span> <span class="o">+</span> <span class="n">bot_message</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">send_text</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">send_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">webhook_handler</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>
        <span class="n">update</span> <span class="o">=</span> <span class="n">telegram</span><span class="o">.</span><span class="n">Update</span><span class="o">.</span><span class="n">de_json</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span> <span class="n">bot</span><span class="p">)</span>
        <span class="c1">#print(update)
</span>        <span class="c1">#print(update.message.text)
</span>        <span class="c1">#print(update.message.chat.id)
</span>        <span class="k">if</span> <span class="p">(</span><span class="n">update</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="nb">id</span> <span class="o">==</span> <span class="n">chat_id</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">telegram_send</span><span class="p">(</span><span class="s">'==&gt;'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">update</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">+</span><span class="s">'&lt;=='</span><span class="p">)</span>
        <span class="c1">#print(ret)
</span>    <span class="k">return</span><span class="p">(</span><span class="s">'ok'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">)</span>
</code></pre></div></div>

<p>åŸ·è¡Œ ngrok port 5000</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./ngrok http 5000
</code></pre></div></div>

<p>çœ‹åˆ° åˆ†æŠ“åˆ°çš„ https</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Forwarding                    https://9dbd9deb.ngrok.io -&gt; http://localhost:5000
</code></pre></div></div>

<p>é…åˆ bot_token ç”¢ç”Ÿç¶²å€ curl ä¸€ä¸‹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl "https://api.telegram.org/bot917681111:AAFpNGEoiebe1yXbkHDVbaauKAjzDSJLjs/setWebhook?url=https://9dbd9deb.ngrok.io/"
</code></pre></div></div>

<p>ä¸Ÿä¸€ä¸‹telegarm ç•«é¢å¯çœ‹åˆ°å›æ‡‰åŠ python æœ‰è¼¸å‡º</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telegram è¼¸å…¥ : è™•ç†ä¸€ä¸‹

telegram è¼¸å…¥ : ==&gt;è™•ç†ä¸€ä¸‹&lt;==

</code></pre></div></div>

<p>python æœ‰è¼¸å‡º</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://api.telegram.org/bot917681111:AAFpNGEoiebe1yXbkHDVbaauKAjzDSJLjs/sendMessage?chat_id=-341335110&amp;parse_mode=Markdown&amp;text===========&gt;è™•ç†ä¸€ä¸‹
</code></pre></div></div>

<p>æ¥ä¸‹ä¾†æ˜¯ ç”¨ google app script ä¾†è©¦è©¦ â€¦..</p>

:ET