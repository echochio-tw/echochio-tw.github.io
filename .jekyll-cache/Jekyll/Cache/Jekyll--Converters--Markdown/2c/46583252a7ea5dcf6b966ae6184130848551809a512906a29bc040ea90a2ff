I"å<p>å…ˆä¸‹è¼‰ linux çš„ mega tools</p>

<p>https://megatools.megous.com/builds/megatools-1.9.98.tar.gz</p>

<p>æ”¾åˆ° /usr/local/bin ä¸‹â€¦â€¦ megacopy . megarm  ,  megarls â€¦â€¦</p>

<p>åœ¨å®¶ç›®éŒ„å»ºç«‹ .megarc æª”æ¡ˆ ,  ä¾‹å¦‚ /root/.megarc</p>

<p>å…§å®¹å¦‚ä¸‹ :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Login]
Username = chio@test.com
Password = P@ssw0rd
</code></pre></div></div>

<p>åŸ·è¡Œ /usr/local/bin/megarls çœ‹çœ‹æ˜¯å¦å¯åŸ·è¡Œ , å¦‚å¯é‚£å°±æ­£å¸¸äº†</p>

<p>å¯«å€‹ /root/mega_backup.sh å®šæ™‚å‚™ä»½æª” â€¦å†æ”¾åˆ° crontab å…§</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm -rf /root/backuptime
touch /root/backuptime
tar -zcvf - /var/vmail |openssl des3 -salt -k password | dd of=/backup/vmail`date +"%Y%m%d"`.tgz.des3
rm -rf /backup/vmail`date -d '2 days ago' +%Y%m%d`.tgz.des3
/usr/local/bin/megarm /Root/vmail/vmail`date -d '2 days ago' +%Y%m%d`.tgz.des3
/usr/local/bin/megacopy -r /Root/vmail -l /backup
python /root/mega-info-mail.py
</code></pre></div></div>

<p>é€™å‚™ä»½æª”æœƒæœƒåˆªé™¤å…©å¤©å‰çš„æª”æ¡ˆ â€¦.è«‹è‡ªè¡Œä¿®æ”¹ â€¦..2 days ago é‚£å­—çœ¼</p>

<p>å‚™ä»½æª”çš„å¯†ç¢¼æ˜¯ password â€¦.è«‹è‡ªè¡Œä¿®æ”¹</p>

<p>é‚„åŸæª”æ¡ˆ (è«‹è‡ªè¡Œä¿®æ”¹ â€¦å¯†ç¢¼ password  ) æ¸¬è©¦ç”¨ tar zvtf -</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dd if=/backup/vmail`date +"%Y%m%d"`.tgz.des3 |openssl des3 -d -k password|tar zvxf -
</code></pre></div></div>

<p>åŠ äº†å€‹ å¯„ä¿¡åˆ° gmail çš„åŠŸèƒ½ â€¦ç”¨ python å¯«çš„ â€¦. /root/mega-info-mail.py</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import smtplib
import subprocess
lsmega = subprocess.check_output(['/usr/local/bin/megals','-l'])
Subject = "Subject: "+ subprocess.check_output(['date'])+" Mega list"
fromaddr = 'testmonitor@gmail.com'
toaddrs  = 'testchio@gmail.com'
msg = "\r\n".join([
  "From: testmonitor@gmail.com",
  "To: testchio@gmail.com",
  Subject,
  "",
  lsmega
  ])
username = 'testmonitor@gmail.com'
password = 'P@ssw0rd'
server = smtplib.SMTP('smtp.gmail.com:587')
server.ehlo()
server.starttls()
server.login(username,password)
server.sendmail(fromaddr, toaddrs, msg)
server.quit()
</code></pre></div></div>
:ET