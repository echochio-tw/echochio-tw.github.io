I"³<p>ç¶²è·¯æœ‰äººæçš„å•é¡Œ , ä¾†è§£è§£çœ‹</p>

<p>åˆ¤æ–·å¼åªè¦ç¢°åˆ°â€åˆä½µå„²å­˜æ ¼â€å°±æœƒåªåˆ¤æ–·ç¬¬ä¸€åˆ—ï¼Œè«‹å•è¦æ€æ¨£èª¿æ•´å…¬å¼?è¬è¬ã€‚</p>

<p>éœ€æ±‚:å¦‚æœGè¡Œæœ‰å­—ä¸²â€DOGâ€ï¼Œå‰‡åœ¨Mè¡Œæ‰“Vï¼Œå¦å‰‡æ‰“X</p>

<p><img src="/images/posts/Execl/p20.png" /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mè¡Œåˆ¤æ–·å¼:=IFERROR(IF(SEARCH("DOG",G2),"V",),"X")
</code></pre></div></div>

<p>æˆ‘çš„åªæœ‰  VBA é€™è¾¦æ³•</p>

<pre><code class="language-`">Sub test()
lr = Cells(1, 6).End(xlDown).Row
B = 0
For xl = 2 To lr
        If Cells(xl, 7).MergeCells = True Then
            If Not (Cells(xl, 7).Value = "") Then
                B = 0
            End If
            If Cells(xl - B, 7).Value = "DOG" Then
                Cells(xl, 13).Value = "V"
                B = B + 1
            Else
                Cells(xl, 13).Value = "X"
                B = B + 1
            End If
        ElseIf Cells(xl, 7).Value = "DOG" Then
            Cells(xl, 13).Value = "V"
            B = 0
        ElseIf Not (Cells(xl, 7).Value = "DOG") Then
            Cells(xl, 13).Value = "X"
            B = 0
        End If
 Next xl
End Sub
</code></pre>
:ET