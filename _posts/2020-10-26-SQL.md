---
layout: post
title: SQL 作業
date: 2020-10-26
tags: sql
---

SQL 作業
<img src="/images/posts/sql/a.png">

How many albums does the artist Led Zeppelin have?

'''
SELECT count(albums.artistid)
FROM albums
WHERE albums.artistid IN (
		SELECT artists.artistid
		FROM artists
		WHERE artists.name = 'Led Zeppelin'
		)
'''
'''
SELECT count(albums.artistid)
FROM artists
INNER JOIN albums ON albums.artistid = artists.artistid
WHERE artists.name = 'Led Zeppelin'
'''

Create a list of album titles and the unit prices for the artist "Audioslave".
'''
SELECT Albums.Title
	,Tracks.UnitPrice
FROM Albums
INNER JOIN Tracks ON Albums.AlbumId = Tracks.AlbumId
INNER JOIN Artists ON Artists.ArtistID = Albums.ArtistID
WHERE Artists.Name = 'Audioslave'
'''
'''
SELECT a.Title, t.UnitPrice
FROM Albums a, Tracks t
WHERE t.AlbumId IN
      (SELECT a.AlbumId
       FROM Albums a
       WHERE a.ArtistID IN
             (SELECT ar.ArtistID
              FROM Artists ar
              WHERE ar.Name = 'Audioslave'))
AND a.AlbumId = t.AlbumId
'''

Find the first and last name of any customer who does not have an invoice. Are there any customers returned from the query?
'''
SELECT customers.customerid
FROM customers
LEFT JOIN invoices ON customers.customerid = invoices.customerid
WHERE invoices.customerid = NULL
'''

Find the total price for each album. What is the total price for the album “Big Ones”?
'''
SELECT sum(tracks.UnitPrice)
FROM tracks
INNER JOIN albums ON tracks.albumid = albums.albumid
WHERE albums.Title = "Big Ones"
'''

How many records are created when you apply a Cartesian join to the invoice and invoice items table?
'''
SELECT count(*)
FROM invoices
CROSS JOIN invoice_items
'''
